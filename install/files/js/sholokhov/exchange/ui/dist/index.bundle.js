this.BX=this.BX||{},this.BX.Sholokhov=this.BX.Sholokhov||{},this.BX.Sholokhov.Exchange=this.BX.Sholokhov.Exchange||{},function(e,t){"use strict";function n(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var i=new WeakMap,a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,e),n(this,i,{writable:!0,value:void 0}),babelHelpers.classPrivateFieldSet(this,i,t)}return babelHelpers.createClass(e,[{key:"has",value:function(e){return null!==this.get(e)}},{key:"get",value:function(e){var t;return null!==(t=babelHelpers.classPrivateFieldGet(this,i)[e])&&void 0!==t?t:null}},{key:"set",value:function(e,t){babelHelpers.classPrivateFieldGet(this,i)[e]=t}},{key:"remove",value:function(e){this.has(e)&&delete babelHelpers.classPrivateFieldGet(this,i)[e]}},{key:"ids",get:function(){return Object.keys(babelHelpers.classPrivateFieldGet(this,i))}}]),e}(),r=function(){function e(t){babelHelpers.classCallCheck(this,e),this._create(t)}return babelHelpers.createClass(e,[{key:"_createValue",value:function(e){}}]),babelHelpers.createClass(e,[{key:"getTitle",value:function(){return this._title}},{key:"getContainer",value:function(){return this._container}},{key:"_create",value:function(e){this._container=document.createElement("div"),this._title=this._createTitle(e),this._container.append(this._title);var t=document.createElement("div");t.className="value",t.append(this._createValue(e)),this._container.append(t)}},{key:"_createTitle",value:function(e){var t=document.createElement("div");return t.innerText=BX.message(e.title),t.className="title",t}}]),e}(),s=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"setAttribute",value:function(e,t){this._input.setAttribute(e,t)}},{key:"_createValue",value:function(e){var t=document.createElement("div");if(t.className="value",this._input=document.createElement("input"),e.events)for(var n in e.events)this._input[n]=e.events[n];if(e.attributes)for(var i in e.attributes)this._input.setAttribute(i,e.attributes[i]);return t.append(this._input),t}},{key:"name",set:function(e){this.setAttribute("name",e)}},{key:"value",set:function(e){this._input.value=e},get:function(){return this._input.value}},{key:"type",set:function(e){this._input.type=e}},{key:"attributes",set:function(e){for(var t in e)this._input.setAttribute(t,e[t])},get:function(){var e=this,t={};return this._input.getAttributeNames().forEach((function(n){return t[n]=e._input.getAttribute(n)})),t}}]),t}(r),l=function(e){var t,n;if(null==e||null===(t=e.api)||void 0===t||!t.action)return new Promise((function(e){e({status:"success",data:{},errors:[]})}));var i={method:"POST",data:(null===(n=e.api)||void 0===n?void 0:n.data)||{}};return new Promise((function(t,n){(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!=t&&t.method||(t.method="POST"),BX.ajax.runAction(e,t)})(e.api.action,i).then((function(e){return t(e)})).catch((function(e){return n(e)}))}))},o=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"addOption",value:function(e){this._select.add(e)}},{key:"removeOption",value:function(e){this._select.options.remove(e)}},{key:"removeAllOptions",value:function(){this._select.options.length=0}},{key:"getOptions",value:function(){return this._select.options}},{key:"getOption",value:function(e){return this._select.options.item(e)}},{key:"setAttribute",value:function(e,t){this._select.setAttribute(e,t)}},{key:"_createValue",value:function(e){var t=this;if(this._select=document.createElement("select"),this._select.add(new Option("-- Выберите значение --","",!0)),"object"===babelHelpers.typeof(e.events))for(var n in e.events)this._select[n]=e.events[n];for(var i in this.attributes)this._select.setAttribute(i,this.attributes[i]);return l(e).then((function(n){var i;null!==(i=e.api)&&void 0!==i&&i.callback&&(n=e.api.callback(n));var a=[];Array.isArray(n.data)?a=n.data:Array.isArray(null==e?void 0:e.enums)&&(a=e.enums),a.forEach((function(e){t.addOption(new Option(e.name,e.value,!1))}))})).catch((function(t){console.error(t),alert('Ошибка получения значений списка "'.concat(e.title,'"'))})),this._select}},{key:"name",set:function(e){this.setAttribute("name",e)}},{key:"value",set:function(e){this.setAttribute("value",e)}},{key:"attributes",set:function(e){for(var t in e)this._select.setAttribute(t,e[t])},get:function(){var e=this,t={};return this._select.getAttributeNames().forEach((function(n){return t[n]=e._select.getAttribute(n)})),t}}]),t}(r),c=function(){function e(){babelHelpers.classCallCheck(this,e),this._create()}return babelHelpers.createClass(e,[{key:"getContainer",value:function(){return this._container}},{key:"_create",value:function(){var e=this;this._container=document.createElement("div"),this._type=t.Factory.create(t.RenderType.Select,{title:"SHOLOKHOV_EXCHANGE_SETTINGS_UI_TITLE_RENDER_IBLOCK_SELECT_TYPE",attributes:{name:"target[iblock_type]"},api:{action:"sholokhov:exchange.IBlockController.getTypes",data:{},callback:this._normalizeTypeResponse},events:{onchange:function(t){return e._selectedType(t)}}}),this._container.append(this._type.getContainer()),this._iBlock=t.Factory.create(t.RenderType.Select,{title:"SHOLOKHOV_EXCHANGE_SETTINGS_UI_TITLE_RENDER_IBLOCK_SELECT_IBLOCK",attributes:{name:"target[iblock_id]"}}),this._container.append(this._iBlock.getContainer())}},{key:"_selectedType",value:function(e){for(var t=this,n=this._iBlock.getOptions(),i=0;i<n.length;i++)n[i].value&&this._iBlock.removeOption(i);e.target.value&&BX.ajax.runAction("sholokhov:exchange.IBlockController.getIBlocks",{method:"POST",data:{parameters:{filter:{IBLOCK_TYPE_ID:e.target.value}}}}).then((function(e){Array.isArray(e.data)&&e.data.forEach((function(e){t._iBlock.addOption(new Option(e.name,e.id))}))})).catch((function(){return alert("Ошибка загрузка получения инфоблоков")}))}},{key:"_normalizeTypeResponse",value:function(e){return Array.isArray(e.data)&&(e.data=e.data.map((function(e){return{value:e.id,name:e.name}}))),e}}]),e}(),u={Input:"input",Select:"select",IBlockSelector:"iblock-selector"},h={};h[u.Input]=s,h[u.Select]=o,h[u.IBlockSelector]=c;var p=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"create",value:function(){return new a(h)}}]),e}();function v(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var b=new WeakMap,f=new(function(){function e(){babelHelpers.classCallCheck(this,e),v(this,b,{writable:!0,value:void 0}),babelHelpers.classPrivateFieldSet(this,b,p.create())}return babelHelpers.createClass(e,[{key:"create",value:function(e,t){var n=babelHelpers.classPrivateFieldGet(this,b).get(e);return n?new n(t):null}}]),e}()),_=p.create();e.Factory=f,e.Registry=_,e.RenderType=u}(this.BX.Sholokhov.Exchange.UI=this.BX.Sholokhov.Exchange.UI||{},BX.Sholokhov.Exchange.UI);
//# sourceMappingURL=index.bundle.js.map
