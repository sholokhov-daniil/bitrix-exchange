this.BX=this.BX||{},this.BX.Sholokhov=this.BX.Sholokhov||{},this.BX.Sholokhov.Exchange=this.BX.Sholokhov.Exchange||{},function(e,t,n){"use strict";function r(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var i=new WeakMap,l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,e),r(this,i,{writable:!0,value:void 0}),babelHelpers.classPrivateFieldSet(this,i,t)}return babelHelpers.createClass(e,[{key:"has",value:function(e){return null!==this.get(e)}},{key:"get",value:function(e){var t;return null!==(t=babelHelpers.classPrivateFieldGet(this,i)[e])&&void 0!==t?t:null}},{key:"set",value:function(e,t){babelHelpers.classPrivateFieldGet(this,i)[e]=t}},{key:"remove",value:function(e){this.has(e)&&delete babelHelpers.classPrivateFieldGet(this,i)[e]}},{key:"ids",get:function(){return Object.keys(babelHelpers.classPrivateFieldGet(this,i))}}]),e}(),o=function(){function e(t){babelHelpers.classCallCheck(this,e),this._create(t)}return babelHelpers.createClass(e,[{key:"_createValue",value:function(e){}}]),babelHelpers.createClass(e,[{key:"getContainer",value:function(){return this._container}},{key:"_create",value:function(e){this._container=document.createElement("tr"),this._titleCell=document.createElement("td"),this._titleCell.width="40%",this._titleCell.className="adm-detail-content-cell-l",this._titleCell.innerText=BX.message(null==e?void 0:e.title),this._valueCell=document.createElement("td"),this._valueCell.width="60%",this._valueCell.className="adm-detail-content-cell-r",this._valueCell.append(this._createValue(e)),this.getContainer().append(this._titleCell),this.getContainer().append(this._valueCell)}},{key:"titleCell",get:function(){return this._titleCell}},{key:"valueCell",get:function(){return this._valueCell}}]),e}(),a=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"setAttribute",value:function(e,t){this._input.setAttribute(e,t)}},{key:"_createValue",value:function(e){var t=document.createElement("div");if(t.className="ui-ctl ui-ctl-textbox",this._input=document.createElement("input"),this._input.className="ui-ctl-element",e.events)for(var n in e.events)this._input[n]=e.events[n];if(e.attributes)for(var r in e.attributes)this._input.setAttribute(r,e.attributes[r]);return t.append(this._input),t}},{key:"name",set:function(e){this.setAttribute("name",e)}},{key:"value",set:function(e){this._input.value=e},get:function(){return this._input.value}},{key:"type",set:function(e){this._input.type=e}},{key:"attributes",set:function(e){for(var t in e)this._input.setAttribute(t,e[t])},get:function(){var e=this,t={};return this._input.getAttributeNames().forEach((function(n){return t[n]=e._input.getAttribute(n)})),t}}]),t}(o),s=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"setAttribute",value:function(e,t){this._input.setAttribute(e,t)}},{key:"_createValue",value:function(e){var t=document.createElement("label");if(t.className="ui-ctl ui-ctl-checkbox",this._input=document.createElement("input"),e.events)for(var n in e.events)this._input[n]=e.events[n];if(e.attributes)for(var r in e.attributes)this._input.setAttribute(r,e.attributes[r]);return this._input.type="checkbox",t.append(this._input),t}},{key:"name",set:function(e){this.setAttribute("name",e)}},{key:"value",set:function(e){this._input.value=e},get:function(){return this._input.value}},{key:"type",set:function(e){this._input.type=e}},{key:"attributes",set:function(e){for(var t in e)this._input.setAttribute(t,e[t])},get:function(){var e=this,t={};return this._input.getAttributeNames().forEach((function(n){return t[n]=e._input.getAttribute(n)})),t}}]),t}(o),c=function(e){var t,n;if(null==e||null===(t=e.api)||void 0===t||!t.action)return new Promise((function(e){e({status:"success",data:{},errors:[]})}));var r={method:"POST",data:(null===(n=e.api)||void 0===n?void 0:n.data)||{}};return new Promise((function(t,n){(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!=t&&t.method||(t.method="POST"),BX.ajax.runAction(e,t)})(e.api.action,r).then((function(e){return t(e)})).catch((function(e){return n(e)}))}))},u=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"addOption",value:function(e){this._select.add(e)}},{key:"removeOption",value:function(e){this._select.options.remove(e)}},{key:"removeAllOptions",value:function(){this._select.options.length=0}},{key:"getOptions",value:function(){return this._select.options}},{key:"getOption",value:function(e){return this._select.options.item(e)}},{key:"setAttribute",value:function(e,t){this._select.setAttribute(e,t)}},{key:"_createValue",value:function(e){var t=this,n=document.createElement("div");n.className="ui-ctl ui-ctl-after-icon ui-ctl-dropdown";var r=document.createElement("div");if(r.className="ui-ctl-after ui-ctl-icon-angle",n.append(r),this._select=document.createElement("select"),this._select.className="ui-ctl-element",this._select.add(new Option("-- Выберите значение --","",!0)),"object"===babelHelpers.typeof(e.events))for(var i in e.events)this._select[i]=e.events[i];for(var l in e.attributes)this._select.setAttribute(l,e.attributes[l]);return c(e).then((function(n){var r;null!==(r=e.api)&&void 0!==r&&r.callback&&(n=e.api.callback(n));var i=[];Array.isArray(n.data)?i=n.data:Array.isArray(null==e?void 0:e.enums)&&(i=e.enums),i.forEach((function(e){t.addOption(new Option(e.name,e.value,!1))}))})).catch((function(t){console.error(t),alert('Ошибка получения значений списка "'.concat(e.title,'"'))})),n.append(this._select),n}},{key:"name",set:function(e){this.setAttribute("name",e)}},{key:"value",set:function(e){this.setAttribute("value",e)}},{key:"attributes",set:function(e){for(var t in e)this._select.setAttribute(t,e[t])},get:function(){var e=this,t={};return this._select.getAttributeNames().forEach((function(n){return t[n]=e._select.getAttribute(n)})),t}}]),t}(o);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var v=function(e){function n(e){var t;return babelHelpers.classCallCheck(this,n),t=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(n).call(this,e)),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"_values",[]),t}return babelHelpers.inherits(n,e),babelHelpers.createClass(n,[{key:"_createValue",value:function(e){var n,r,i,l=this,o=document.createElement("div");null!=e&&null!==(n=e.selector)&&void 0!==n&&n.addButtonCaption&&(e.selector.addButtonCaption=BX.message(e.selector.addButtonCaption)||e.selector.addButtonCaption);var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},null==e?void 0:e.selector);if(a.hasOwnProperty("events")||(a.events={}),null!==(r=a.events)&&void 0!==r&&r.onAfterTagAdd){var s,c=null===(s=a.events)||void 0===s?void 0:s.onAfterTagAdd;a.events.onAfterTagAdd=function(t){l._generateHiddenInputs(t.target,e),c(t)}}else a.events.onAfterTagAdd=function(t){return l._generateHiddenInputs(t.target,e)};if(null!==(i=a.events)&&void 0!==i&&i.onAfterTagRemove){var u,v=null===(u=a.events)||void 0===u?void 0:u.onAfterTagRemove;a.events.onAfterTagRemove=function(t){l._generateHiddenInputs(t.target,e),v(t)}}else a.events.onAfterTagRemove=function(t){return l._generateHiddenInputs(t.target,e)};return this._selector=new t.TagSelector(a),this.selector.renderTo(o),o}},{key:"_generateHiddenInputs",value:function(e,t){var n=this;this._values.forEach((function(e){return e.remove()})),t.name&&e.getTags().forEach((function(e){var r=document.createElement("input");r.name=t.name,r.type="hidden",r.value=e.id,n._values.push(r),n.getContainer().append(r)}))}},{key:"selector",get:function(){return this._selector}}]),n}(o);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=function(){function e(t){babelHelpers.classCallCheck(this,e),this._options=t}return babelHelpers.createClass(e,[{key:"getContainer",value:function(){var e;return null!==(e=this._container)&&void 0!==e?e:this._container=this._create()}},{key:"_create",value:function(){var e=document.createElement("div");return e.append(this._createIBlockSelector().getContainer()),e}},{key:"_iBlockSelected",value:function(e){var t,n;null===(t=this._property)||void 0===t||null===(n=t.getContainer())||void 0===n||n.remove(),this._createPropertySelector(e.data.tag.id),this._container.append(this._property.getContainer())}},{key:"_iBlockRemove",value:function(e){var t,n,r,i;null!==(t=e.target)&&void 0!==t&&null!==(n=t.tags)&&void 0!==n&&n.length||(null===(r=this._property)||void 0===r||null===(i=r.getContainer())||void 0===i||i.remove())}},{key:"_createIBlockSelector",value:function(){var e,t,n=this;return this._iBlock=new v({title:"SHOLOKHOV_EXCHANGE_SETTINGS_UI_TITLE_RENDER_IBLOCK_SELECT_IBLOCK",name:null===(e=this._options)||void 0===e||null===(t=e.iblock)||void 0===t?void 0:t.name,selector:{multiple:!1,addButtonCaption:"SHOLOHKOV_EXCHANGE_UI_ENTITY_SELECTOR_DIALOG_ADD_BUTTON_CAPTION_SELECT",dialogOptions:{entities:[{id:"sholokhov-exchange-iblock",dynamicSearch:!0,dynamicLoad:!0}]},events:{onAfterTagAdd:function(e){return n._iBlockSelected(e)},onAfterTagRemove:function(e){return n._iBlockRemove(e)}}}})}},{key:"_createPropertySelector",value:function(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._property=new v({title:"SHOLOKHOV_EXCHANGE_UI_ENTITY_PROPERTY_SELECTOR",name:null===(e=this._options)||void 0===e||null===(t=e.property)||void 0===t?void 0:t.name,selector:{multiple:!1,addButtonCaption:"SHOLOHKOV_EXCHANGE_UI_ENTITY_SELECTOR_DIALOG_ADD_BUTTON_CAPTION_SELECT",dialogOptions:{entities:[{id:"sholokhov-exchange-iblock-property",dynamicSearch:!0,dynamicLoad:!0,options:d({iblockId:i,nameTemplate:"#NAME# (#CODE#)"},(null===(n=this._options)||void 0===n||null===(r=n.property)||void 0===r?void 0:r.api)||{})}]}}})}}]),e}();function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(){function e(t){babelHelpers.classCallCheck(this,e),this._options=t}return babelHelpers.createClass(e,[{key:"getContainer",value:function(){var e;return null!==(e=this._container)&&void 0!==e?e:this._container=this._create()}},{key:"_create",value:function(){var e=document.createElement("div");return e.append(this._createIBlockSelector().getContainer()),e}},{key:"_iBlockSelected",value:function(e){var t,n;null===(t=this._property)||void 0===t||null===(n=t.getContainer())||void 0===n||n.remove(),this._createPropertySelector(e.data.tag.id),this._container.append(this._property.getContainer())}},{key:"_iBlockRemove",value:function(e){var t,n,r,i;null!==(t=e.target)&&void 0!==t&&null!==(n=t.tags)&&void 0!==n&&n.length||(null===(r=this._property)||void 0===r||null===(i=r.getContainer())||void 0===i||i.remove())}},{key:"_createIBlockSelector",value:function(){var e,t,n=this;return this._iBlock=new v({title:"SHOLOKHOV_EXCHANGE_SETTINGS_UI_TITLE_RENDER_IBLOCK_SELECT_IBLOCK",name:null===(e=this._options)||void 0===e||null===(t=e.iblock)||void 0===t?void 0:t.name,selector:{multiple:!1,addButtonCaption:"SHOLOHKOV_EXCHANGE_UI_ENTITY_SELECTOR_DIALOG_ADD_BUTTON_CAPTION_SELECT",dialogOptions:{entities:[{id:"sholokhov-exchange-iblock",dynamicSearch:!0,dynamicLoad:!0}]},events:{onAfterTagAdd:function(e){return n._iBlockSelected(e)},onAfterTagRemove:function(e){return n._iBlockRemove(e)}}}})}},{key:"_createPropertySelector",value:function(e){var t,n,r,i;return this._property=new v({title:"SHOLOKHOV_EXCHANGE_UI_ENTITY_PROPERTY_SELECTOR",name:null===(t=this._options)||void 0===t||null===(n=t.property)||void 0===n?void 0:n.name,selector:{multiple:!1,addButtonCaption:"SHOLOHKOV_EXCHANGE_UI_ENTITY_SELECTOR_DIALOG_ADD_BUTTON_CAPTION_SELECT",dialogOptions:{entities:[{id:"sholokhov-exchange-user-field",dynamicSearch:!0,dynamicLoad:!0,options:_({entityId:"IBLOCK_".concat(e,"_SECTION"),nameTemplate:"#LIST_COLUMN_LABEL# (#FIELD_NAME#)"},(null===(r=this._options)||void 0===r||null===(i=r.property)||void 0===i?void 0:i.api)||{})}]}}})}}]),e}(),O={Input:"input",Checkbox:"checkbox",Select:"select",EntitySelector:"entity-selector",IBlockProperty:"iblock-property",UfProperty:"uf-property"},m={};m[O.Input]=a,m[O.Checkbox]=s,m[O.Select]=u,m[O.EntitySelector]=v,m[O.IBlockProperty]=b,m[O.UfProperty]=y;var g=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"create",value:function(){return new l(m)}}]),e}();function C(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var k=new WeakMap,E=new(function(){function e(){babelHelpers.classCallCheck(this,e),C(this,k,{writable:!0,value:void 0}),babelHelpers.classPrivateFieldSet(this,k,g.create())}return babelHelpers.createClass(e,[{key:"create",value:function(e,t){var n=babelHelpers.classPrivateFieldGet(this,k).get(e);return n?new n(t):null}}]),e}()),H=g.create();e.Factory=E,e.Registry=H,e.RenderType=O}(this.BX.Sholokhov.Exchange.UI=this.BX.Sholokhov.Exchange.UI||{},BX.UI.EntitySelector,BX);
//# sourceMappingURL=index.bundle.js.map
