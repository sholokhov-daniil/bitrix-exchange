this.BX=this.BX||{},this.BX.Sholokhov=this.BX.Sholokhov||{},this.BX.Sholokhov.Exchange=this.BX.Sholokhov.Exchange||{},function(e,t,n){"use strict";function i(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var r=new WeakMap,l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,e),i(this,r,{writable:!0,value:void 0}),babelHelpers.classPrivateFieldSet(this,r,t)}return babelHelpers.createClass(e,[{key:"has",value:function(e){return null!==this.get(e)}},{key:"get",value:function(e){var t;return null!==(t=babelHelpers.classPrivateFieldGet(this,r)[e])&&void 0!==t?t:null}},{key:"set",value:function(e,t){babelHelpers.classPrivateFieldGet(this,r)[e]=t}},{key:"remove",value:function(e){this.has(e)&&delete babelHelpers.classPrivateFieldGet(this,r)[e]}},{key:"ids",get:function(){return Object.keys(babelHelpers.classPrivateFieldGet(this,r))}}]),e}(),a=function(){function e(t){babelHelpers.classCallCheck(this,e),this._create(t)}return babelHelpers.createClass(e,[{key:"_createValue",value:function(e){}}]),babelHelpers.createClass(e,[{key:"getContainer",value:function(){return this._container}},{key:"_create",value:function(e){this._container=document.createElement("tr"),this._titleCell=document.createElement("td"),this._titleCell.width="40%",this._titleCell.className="adm-detail-content-cell-l",this._titleCell.innerText=BX.message(null==e?void 0:e.title),this._valueCell=document.createElement("td"),this._valueCell.width="60%",this._valueCell.className="adm-detail-content-cell-r",this._valueCell.append(this._createValue(e)),this.getContainer().append(this._titleCell),this.getContainer().append(this._valueCell)}},{key:"titleCell",get:function(){return this._titleCell}},{key:"valueCell",get:function(){return this._valueCell}}]),e}(),o=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"setAttribute",value:function(e,t){this._input.setAttribute(e,t)}},{key:"_createValue",value:function(e){var t=document.createElement("div");if(t.className="ui-ctl ui-ctl-textbox",this._input=document.createElement("input"),this._input.className="ui-ctl-element",e.events)for(var n in e.events)this._input[n]=e.events[n];if(e.attributes)for(var i in e.attributes)this._input.setAttribute(i,e.attributes[i]);return t.append(this._input),t}},{key:"name",set:function(e){this.setAttribute("name",e)}},{key:"value",set:function(e){this._input.value=e},get:function(){return this._input.value}},{key:"type",set:function(e){this._input.type=e}},{key:"attributes",set:function(e){for(var t in e)this._input.setAttribute(t,e[t])},get:function(){var e=this,t={};return this._input.getAttributeNames().forEach((function(n){return t[n]=e._input.getAttribute(n)})),t}}]),t}(a),s=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"setAttribute",value:function(e,t){this._input.setAttribute(e,t)}},{key:"_createValue",value:function(e){var t=document.createElement("label");if(t.className="ui-ctl ui-ctl-checkbox",this._input=document.createElement("input"),e.events)for(var n in e.events)this._input[n]=e.events[n];if(e.attributes)for(var i in e.attributes)this._input.setAttribute(i,e.attributes[i]);return this._input.type="checkbox",t.append(this._input),t}},{key:"name",set:function(e){this.setAttribute("name",e)}},{key:"value",set:function(e){this._input.value=e},get:function(){return this._input.value}},{key:"type",set:function(e){this._input.type=e}},{key:"attributes",set:function(e){for(var t in e)this._input.setAttribute(t,e[t])},get:function(){var e=this,t={};return this._input.getAttributeNames().forEach((function(n){return t[n]=e._input.getAttribute(n)})),t}}]),t}(a),c=function(e){var t,n;if(null==e||null===(t=e.api)||void 0===t||!t.action)return new Promise((function(e){e({status:"success",data:{},errors:[]})}));var i={method:"POST",data:(null===(n=e.api)||void 0===n?void 0:n.data)||{}};return new Promise((function(t,n){(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!=t&&t.method||(t.method="POST"),BX.ajax.runAction(e,t)})(e.api.action,i).then((function(e){return t(e)})).catch((function(e){return n(e)}))}))},u=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"addOption",value:function(e){this._select.add(e)}},{key:"removeOption",value:function(e){this._select.options.remove(e)}},{key:"removeAllOptions",value:function(){this._select.options.length=0}},{key:"getOptions",value:function(){return this._select.options}},{key:"getOption",value:function(e){return this._select.options.item(e)}},{key:"setAttribute",value:function(e,t){this._select.setAttribute(e,t)}},{key:"_createValue",value:function(e){var t=this,n=document.createElement("div");n.className="ui-ctl ui-ctl-after-icon ui-ctl-dropdown";var i=document.createElement("div");if(i.className="ui-ctl-after ui-ctl-icon-angle",n.append(i),this._select=document.createElement("select"),this._select.className="ui-ctl-element",this._select.add(new Option("-- Выберите значение --","",!0)),"object"===babelHelpers.typeof(e.events))for(var r in e.events)this._select[r]=e.events[r];for(var l in this.attributes)this._select.setAttribute(l,this.attributes[l]);return c(e).then((function(n){var i;null!==(i=e.api)&&void 0!==i&&i.callback&&(n=e.api.callback(n));var r=[];Array.isArray(n.data)?r=n.data:Array.isArray(null==e?void 0:e.enums)&&(r=e.enums),r.forEach((function(e){t.addOption(new Option(e.name,e.value,!1))}))})).catch((function(t){console.error(t),alert('Ошибка получения значений списка "'.concat(e.title,'"'))})),n.append(this._select),n}},{key:"name",set:function(e){this.setAttribute("name",e)}},{key:"value",set:function(e){this.setAttribute("value",e)}},{key:"attributes",set:function(e){for(var t in e)this._select.setAttribute(t,e[t])},get:function(){var e=this,t={};return this._select.getAttributeNames().forEach((function(n){return t[n]=e._select.getAttribute(n)})),t}}]),t}(a),p=function(e){function n(e){return babelHelpers.classCallCheck(this,n),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(n).call(this,e))}return babelHelpers.inherits(n,e),babelHelpers.createClass(n,[{key:"_createValue",value:function(e){var n,i=document.createElement("div");return null!=e&&null!==(n=e.selector)&&void 0!==n&&n.addButtonCaption&&(e.selector.addButtonCaption=BX.message(e.selector.addButtonCaption)||e.selector.addButtonCaption),this._selector=new t.TagSelector((null==e?void 0:e.selector)||{}),this.selector.renderTo(i),i}},{key:"selector",get:function(){return this._selector}}]),n}(a);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=function(){function e(t){babelHelpers.classCallCheck(this,e),this._options=t}return babelHelpers.createClass(e,[{key:"getContainer",value:function(){var e;return null!==(e=this._container)&&void 0!==e?e:this._container=this._create()}},{key:"_create",value:function(){var e=document.createElement("div");return e.append(this._createIBlockSelector().getContainer()),e}},{key:"_iBlockSelected",value:function(e){var t,n;null===(t=this._property)||void 0===t||null===(n=t.getContainer())||void 0===n||n.remove(),this._createPropertySelector(e.data.tag.id),this._container.append(this._property.getContainer())}},{key:"_iBlockRemove",value:function(e){var t,n,i,r;null!==(t=e.target)&&void 0!==t&&null!==(n=t.tags)&&void 0!==n&&n.length||(null===(i=this._property)||void 0===i||null===(r=i.getContainer())||void 0===r||r.remove())}},{key:"_createIBlockSelector",value:function(){var e=this;return this._iBlock=new p({title:"SHOLOKHOV_EXCHANGE_SETTINGS_UI_TITLE_RENDER_IBLOCK_SELECT_IBLOCK",selector:{multiple:!1,addButtonCaption:"SHOLOHKOV_EXCHANGE_UI_ENTITY_SELECTOR_DIALOG_ADD_BUTTON_CAPTION_SELECT",dialogOptions:{entities:[{id:"sholokhov-exchange-iblock",dynamicSearch:!0,dynamicLoad:!0}]},events:{onAfterTagAdd:function(t){return e._iBlockSelected(t)},onAfterTagRemove:function(t){return e._iBlockRemove(t)}}}})}},{key:"_createPropertySelector",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._property=new p({title:"SHOLOKHOV_EXCHANGE_UI_ENTITY_PROPERTY_SELECTOR",selector:{multiple:!1,addButtonCaption:"SHOLOHKOV_EXCHANGE_UI_ENTITY_SELECTOR_DIALOG_ADD_BUTTON_CAPTION_SELECT",dialogOptions:{entities:[{id:"sholokhov-exchange-iblock-property",dynamicSearch:!0,dynamicLoad:!0,options:v({iblockId:n,nameTemplate:"#NAME# (#CODE#)"},(null===(e=this._options)||void 0===e||null===(t=e.property)||void 0===t?void 0:t.api)||{})}]}}})}}]),e}();function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"getContainer",value:function(){var e;return null!==(e=this._container)&&void 0!==e?e:this._container=this._create()}},{key:"_create",value:function(){var e=document.createElement("div");return e.append(this._createIBlockSelector().getContainer()),e}},{key:"_iBlockSelected",value:function(e){var t,n;null===(t=this._property)||void 0===t||null===(n=t.getContainer())||void 0===n||n.remove(),this._createPropertySelector(e.data.tag.id),this._container.append(this._property.getContainer())}},{key:"_iBlockRemove",value:function(e){var t,n,i,r;null!==(t=e.target)&&void 0!==t&&null!==(n=t.tags)&&void 0!==n&&n.length||(null===(i=this._property)||void 0===i||null===(r=i.getContainer())||void 0===r||r.remove())}},{key:"_createIBlockSelector",value:function(){var e=this;return this._iBlock=new p({title:"SHOLOKHOV_EXCHANGE_SETTINGS_UI_TITLE_RENDER_IBLOCK_SELECT_IBLOCK",selector:{multiple:!1,addButtonCaption:"SHOLOHKOV_EXCHANGE_UI_ENTITY_SELECTOR_DIALOG_ADD_BUTTON_CAPTION_SELECT",dialogOptions:{entities:[{id:"sholokhov-exchange-iblock",dynamicSearch:!0,dynamicLoad:!0}]},events:{onAfterTagAdd:function(t){return e._iBlockSelected(t)},onAfterTagRemove:function(t){return e._iBlockRemove(t)}}}})}},{key:"_createPropertySelector",value:function(e){var t,n;return this._property=new p({title:"SHOLOKHOV_EXCHANGE_UI_ENTITY_PROPERTY_SELECTOR",selector:{multiple:!1,addButtonCaption:"SHOLOHKOV_EXCHANGE_UI_ENTITY_SELECTOR_DIALOG_ADD_BUTTON_CAPTION_SELECT",dialogOptions:{entities:[{id:"sholokhov-exchange-user-field",dynamicSearch:!0,dynamicLoad:!0,options:d({entityId:"IBLOCK_".concat(e,"_SECTION"),nameTemplate:"#LIST_COLUMN_LABEL# (#FIELD_NAME#)"},(null===(t=this._options)||void 0===t||null===(n=t.property)||void 0===n?void 0:n.api)||{})}]}}})}}]),e}(),y={Input:"input",Checkbox:"checkbox",Select:"select",EntitySelector:"entity-selector",IBlockProperty:"iblock-property",UfProperty:"uf-property"},C={};C[y.Input]=o,C[y.Checkbox]=s,C[y.Select]=u,C[y.EntitySelector]=p,C[y.IBlockProperty]=b,C[y.UfProperty]=f;var O=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"create",value:function(){return new l(C)}}]),e}();function k(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var m=new WeakMap,E=new(function(){function e(){babelHelpers.classCallCheck(this,e),k(this,m,{writable:!0,value:void 0}),babelHelpers.classPrivateFieldSet(this,m,O.create())}return babelHelpers.createClass(e,[{key:"create",value:function(e,t){var n=babelHelpers.classPrivateFieldGet(this,m).get(e);return n?new n(t):null}}]),e}()),g=O.create();e.Factory=E,e.Registry=g,e.RenderType=y}(this.BX.Sholokhov.Exchange.UI=this.BX.Sholokhov.Exchange.UI||{},BX.UI.EntitySelector,BX);
//# sourceMappingURL=index.bundle.js.map
