(function(){"use strict";var e={1641:function(e,t,o){var n=o(1114),a=o(5130),l=o(6768),u=o(4232),r=o(144);const i={class:"ui-ctl ui-ctl-checkbox"},d=["name"],s={class:"ui-ctl-label-text"};var c={__name:"checkbox-field",props:(0,l.zz)({modelValue:{type:Boolean,default:()=>!1},name:{type:String,required:!0},label:{type:String,default:()=>""}},{modelValue:{default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,l.fn)(e,"modelValue");return(o,n)=>((0,l.uX)(),(0,l.CE)("label",i,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>t.value=e),name:e.name,type:"checkbox",class:"ui-ctl-element"},null,8,d),[[a.lH,t.value]]),(0,l.Lk)("div",s,(0,u.v_)(e.label),1)]))}};const p=c;var m=p;function v(e,t,o={}){const n={...o,data:t};return BX.ajax.runAction(e,n)}function f(e,t){return E(e)?BX.Loc.getMessage(e,t):""}function E(e){return BX.Loc.hasMessage(e)}const _={emit(e,t){BX.Event.EventEmitter.emit(e,t)},subscribe(e,t){BX.Event.EventEmitter.subscribe(e,t)}},h={class:"ui-ctl ui-ctl-after-icon ui-ctl-dropdown"},g={class:"ui-ctl-after ui-ctl-icon-angle"},y=["name"],k={value:""},V=["value"];var T={__name:"select-field",props:(0,l.zz)({name:{type:String,required:!0},attributes:{type:Object,default:()=>{}},api:{type:Object,default:()=>{}},values:{type:Array,default:()=>[]}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,l.fn)(e,"modelValue"),o=e,n=(0,r.Kh)({enums:[]});(0,l.sV)(()=>{o.api?.action?i():o.values&&(n.enums=o.values)}),(0,l.wB)(()=>o.api,()=>i(),{deep:!0}),(0,l.wB)(()=>o.values,e=>n.enums=e);const i=()=>{v(o.api.action,o.api?.data||{}).then(e=>{o.api?.callback&&(e=o.api?.callback(e)),n.enums=Array.isArray(e.data)?e.data:[]}).catch(e=>{console.error(e),alert("Ошибка получения значений списка")})};return(o,i)=>((0,l.uX)(),(0,l.CE)("div",h,[(0,l.Lk)("div",g,[(0,l.bo)((0,l.Lk)("select",(0,l.v6)({"onUpdate:modelValue":i[0]||(i[0]=e=>t.value=e),name:e.name,class:"ui-ctl-element"},e.attributes),[(0,l.Lk)("option",k,(0,u.v_)((0,r.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_SELECT_SELECTED_VALUE")),1),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.enums,e=>((0,l.uX)(),(0,l.CE)("option",{key:e.value,value:e.value},(0,u.v_)(e.name),9,V))),128))],16,y),[[a.u1,t.value]])])]))}};const b=T;var C=b,O=(o(4114),o(8111),o(7588),{__name:"entity-selector-field",props:(0,l.zz)({selector:{type:Object}},{modelValue:{},modelModifiers:{}}),emits:(0,l.zz)(["onTagAdd","onBeforeTagAdd","onAfterTagAdd","onBeforeTagRemove","onTagRemove","onAfterTagRemove","onContainerClick","onInput","onBlur","onKeyUp","onEnter","onMetaEnter","onKeyDown","onAddButtonClick","onCreateButtonClick","afterRender"],["update:modelValue"]),setup(e,{emit:t}){const o=(0,l.fn)(e,"modelValue"),n=(0,r.KR)(),a=t,u=e,i=(0,r.Kh)({value:"",options:{},addButtonCaption:""});(0,l.sV)(()=>{d(),s()}),(0,l.wB)(()=>o.value,e=>{e!==i.value&&s()});const d=()=>{i.options={...u.selector},i.options?.addButtonCaption&&(i.options.addButtonCaption=f(i.options.addButtonCaption)||i.options.addButtonCaption),i.options.events={onTagAdd:e=>a("onTagAdd",e),onBeforeTagAdd:e=>a("onBeforeTagAdd",e),onAfterTagAdd:e=>{c(e),a("onAfterTagAdd",e)},onBeforeTagRemove:e=>a("onBeforeTagRemove",e),onTagRemove:e=>a("onTagRemove",e),onAfterTagRemove:e=>{c(e),a("onAfterTagRemove",e)},onContainerClick:e=>a("onContainerClick",e),onInput:e=>a("onInput",e),onBlur:e=>a("onBlur",e),onKeyUp:e=>a("onKeyUp",e),onEnter:e=>a("onEnter",e),onMetaEnter:e=>a("onMetaEnter",e),onKeyDown:e=>a("onKeyDown",e),onAddButtonClick:e=>a("onAddButtonClick",e),onCreateButtonClick:e=>a("onCreateButtonClick",e)}},s=()=>{BX.loadExt("ui.entity-selector").then(()=>{const e=new BX.UI.EntitySelector.TagSelector(i.options);if(n.value){n.value.innerHTML="";const t=new Promise(t=>{e.renderTo(n.value),t(e)});t.then(e=>a("afterRender",e))}})},c=e=>{let t;const n=e.target;n.isMultiple()?(t=[],e.target.getTags().forEach(e=>t.push(e.id))):t=n.getTags()[0]?.id??"",o.value=i.value=t};return(e,t)=>((0,l.uX)(),(0,l.CE)("div",{ref_key:"container",ref:n},null,512))}});const L=O;var A=L;const S={class:"ui-ctl ui-ctl-checkbox"},w=["name"];var B={__name:"input-field",props:(0,l.zz)({name:{type:String,required:!0}},{modelValue:{default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,l.fn)(e,"modelValue");return(o,n)=>((0,l.uX)(),(0,l.CE)("div",S,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>t.value=e),name:e.name,type:"text",class:"ui-ctl-element"},null,8,w),[[a.Jo,t.value]])]))}};const I=B;var R=I;const X={class:"ui-ctl ui-ctl-textbox"};var U={__name:"input-hash-field",props:(0,l.zz)({name:{type:String,required:!0},label:{type:String,default:()=>""}},{modelValue:{default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,l.fn)(e,"modelValue"),o=()=>{v("sholokhov:exchange.SecureController.generateHash").then(e=>t.value=e.data).catch(()=>alert("Ошибка генерации идентификатора"))};return(e,n)=>((0,l.uX)(),(0,l.CE)("div",X,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>t.value=e),type:"text",class:"ui-ctl-element"},null,512),[[a.Jo,t.value]]),(0,l.Lk)("span",{class:"hash-text-generator",onClick:o},"Сгенерировать")]))}};const H=U;var N=H;const x={width:"40%"},K={width:"60%"},G={key:0},D={width:"40%"},F={width:"60%"};var M={__name:"iblock-property-selector",props:{modelValue:{type:Object,default:()=>{}},property:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,n=t,a=(0,r.Kh)({iBlockOptions:{multiple:!1,addButtonCaption:"SHOLOHKOV_EXCHANGE_UI_ENTITY_SELECTOR_DIALOG_ADD_BUTTON_CAPTION_SELECT",dialogOptions:{entities:[{id:"sholokhov-exchange-iblock",dynamicSearch:!0,dynamicLoad:!0}]}}}),i=(0,l.EW)({get(){return o.modelValue||n("update:modelValue",{}),o.modelValue},set(e){n("update:modelValue",e)}}),d=(0,l.EW)({get(){return i.value?.iblock_id},set(e){e||(s.value=""),i.value.iblock_id=e}}),s=(0,l.EW)({get(){return i.value?.property_id},set(e){i.value.property_id=e}}),c=(0,l.EW)(()=>({multiple:!1,addButtonCaption:"SHOLOHKOV_EXCHANGE_UI_ENTITY_SELECTOR_DIALOG_ADD_BUTTON_CAPTION_SELECT",dialogOptions:{entities:[{id:"sholokhov-exchange-iblock-property",dynamicSearch:!0,dynamicLoad:!0,options:{iblockId:d,nameTemplate:"#NAME# (#CODE#)",...o.property?.api||{}}}]}}));return(e,t)=>((0,l.uX)(),(0,l.CE)("table",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("td",x,(0,u.v_)((0,r.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_UI_TITLE_RENDER_IBLOCK_SELECT_IBLOCK")),1),(0,l.Lk)("td",K,[(0,l.bF)(A,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),selector:a.iBlockOptions},null,8,["modelValue","selector"])])]),d.value?((0,l.uX)(),(0,l.CE)("tr",G,[(0,l.Lk)("td",D,(0,u.v_)((0,r.R1)(f)("SHOLOKHOV_EXCHANGE_UI_ENTITY_PROPERTY_SELECTOR")),1),(0,l.Lk)("td",F,[(0,l.bF)(A,{modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=e=>s.value=e),selector:c.value},null,8,["modelValue","selector"])])])):(0,l.Q3)("",!0)]))}};const j=M;var z=j;const W=e=>{let t=null;switch(e){case"input":t=R;break;case"checkbox":t=m;break;case"select":t=C;break;case"entity-selector":t=A;break;case"iblock-property":t=z;break}return t};var q={__name:"dynamic-field",props:(0,l.zz)({view:{type:String,required:!0},entity:{type:String,default:()=>""},options:{type:Object,default:()=>{}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,l.fn)(e,"modelValue"),o=e;(0,l.wB)(()=>t.value,e=>_.emit("sholokhov.exchange:uiUpdateValueDynamicField",{value:e,entity:o.entity}));const n=(0,l.EW)(()=>W(o.view));return(o,a)=>((0,l.uX)(),(0,l.Wv)((0,l.$y)(n.value),(0,l.v6)({modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value=e)},e.options),null,16,["modelValue"]))}};const P=q;var Y=P;const Q={width:"60%"},$={width:"40%"},J={width:"60%"};var Z={__name:"general-block",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const t=(0,l.fn)(e,"modelValue");return(e,o)=>((0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("tr",null,[o[2]||(o[2]=(0,l.Lk)("td",{width:"40%"},null,-1)),(0,l.Lk)("td",Q,[(0,l.bF)((0,r.R1)(m),{modelValue:t.value.active,"onUpdate:modelValue":o[0]||(o[0]=e=>t.value.active=e),label:(0,r.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_ENTITY_UI_GENERAL_TITLE_FIELD_ACTIVE"),name:"active"},null,8,["modelValue","label"])])]),(0,l.Lk)("tr",null,[(0,l.Lk)("td",$,(0,u.v_)((0,r.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_ENTITY_UI_GENERAL_TITLE_FIELD_HASH")),1),(0,l.Lk)("td",J,[(0,l.bF)((0,r.R1)(N),{modelValue:t.value.hash,"onUpdate:modelValue":o[1]||(o[1]=e=>t.value.hash=e),name:"hash"},null,8,["modelValue"])])])],64))}};const ee=Z;var te=ee;o(1701);const oe={width:"40%"},ne={width:"60%"};function ae(e,t){return(0,l.uX)(),(0,l.CE)("tr",null,[(0,l.Lk)("td",oe,[(0,l.RG)(e.$slots,"title")]),(0,l.Lk)("td",ne,[(0,l.RG)(e.$slots,"content")])])}var le=o(1241);const ue={},re=(0,le.A)(ue,[["render",ae]]);var ie=re,de={__name:"target-block",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const t=(0,l.fn)(e,"modelValue"),o=(0,r.Kh)({targets:[],fields:[]}),n=(0,l.EW)(()=>({action:"sholokhov:exchange.EntityController.getByType",data:{code:"target"},callback:a}));(0,l.wB)(()=>t.value.type,e=>{t.value={type:t.value.type},i(e)});const a=e=>(Array.isArray(e.data)&&(e.data=e.data.map(e=>({value:e.CODE,name:e.NAME}))),e),i=e=>{v("sholokhov:exchange.EntityController.getFields",{code:e}).then(e=>o.fields=Array.isArray(e.data)?e.data:[]).catch(e=>console.error(e))};return(e,a)=>((0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(ie,null,{title:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)((0,r.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_ENTITY_UI_TARGET_TITLE_FIELD_TYPE")),1)]),content:(0,l.k6)(()=>[(0,l.bF)((0,r.R1)(C),{modelValue:t.value.type,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value.type=e),api:n.value,name:"type"},null,8,["modelValue","api"])]),_:1}),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.fields,(e,o)=>((0,l.uX)(),(0,l.Wv)(ie,{key:o},{title:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)((0,r.R1)(f)(e?.title)),1)]),content:(0,l.k6)(()=>[(0,l.bF)((0,r.R1)(Y),{modelValue:t.value[e.name],"onUpdate:modelValue":o=>t.value[e.name]=o,view:e.view,entity:t.value.type,options:e.options},null,8,["modelValue","onUpdate:modelValue","view","entity","options"])]),_:2},1024))),128))],64))}};const se=de;var ce=se,pe={__name:"App",props:{teleport:{type:Object,required:!0},formContainer:{type:String,required:!0},signed:{type:String,required:!1,default:()=>""}},setup(e){const t=e,o=(0,r.Kh)({form:{general:{},target:{},source:{},map:{}}});(0,l.sV)(()=>n());const n=()=>{console.log(t);const e=document.querySelector(t.formContainer);e&&e.addEventListener("submit",e=>a(e))},a=e=>{e.preventDefault(),e.stopImmediatePropagation()};return(t,n)=>((0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.eW)((0,u.v_)(o.form)+" ",1),e.teleport.general?((0,l.uX)(),(0,l.Wv)(l.Im,{key:0,to:e.teleport.general},[(0,l.bF)(te,{modelValue:o.form.general,"onUpdate:modelValue":n[0]||(n[0]=e=>o.form.general=e)},null,8,["modelValue"])],8,["to"])):(0,l.Q3)("",!0),e.teleport.target?((0,l.uX)(),(0,l.Wv)(l.Im,{key:1,to:e.teleport.target},[(0,l.bF)(ce,{modelValue:o.form.target,"onUpdate:modelValue":n[1]||(n[1]=e=>o.form.target=e)},null,8,["modelValue"])],8,["to"])):(0,l.Q3)("",!0)],64))}};const me=pe;var ve=me;window.Sholokhov||(window.Sholokhov={}),window.Sholokhov.Exchange||(window.Sholokhov.Exchange={}),window.Sholokhov.Exchange.Detail||(window.Sholokhov.Exchange.Detail=new class{constructor(){(0,n.A)(this,"_app",void 0)}mounted(e,t){console.log(BX.Loc.getMessage("LANGUAGE_ID")),this._app=(0,a.Ef)(ve,t),this._app.mount(e)}unmount(){this._app?.unmount()}})}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var l=t[n]={exports:{}};return e[n].call(l.exports,l,l.exports,o),l.exports}o.m=e,function(){var e=[];o.O=function(t,n,a,l){if(!n){var u=1/0;for(s=0;s<e.length;s++){n=e[s][0],a=e[s][1],l=e[s][2];for(var r=!0,i=0;i<n.length;i++)(!1&l||u>=l)&&Object.keys(o.O).every(function(e){return o.O[e](n[i])})?n.splice(i--,1):(r=!1,l<u&&(u=l));if(r){e.splice(s--,1);var d=a();void 0!==d&&(t=d)}}return t}l=l||0;for(var s=e.length;s>0&&e[s-1][2]>l;s--)e[s]=e[s-1];e[s]=[n,a,l]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,l,u=n[0],r=n[1],i=n[2],d=0;if(u.some(function(t){return 0!==e[t]})){for(a in r)o.o(r,a)&&(o.m[a]=r[a]);if(i)var s=i(o)}for(t&&t(n);d<u.length;d++)l=u[d],o.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return o.O(s)},n=self["webpackChunkdetail"]=self["webpackChunkdetail"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[504],function(){return o(1641)});n=o.O(n)})();