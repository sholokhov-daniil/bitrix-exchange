(function(){"use strict";var e={9659:function(e,t,o){var l=o(1114),n=o(5130),a=o(6768),u=o(144),r=o(4232);const i={class:"ui-ctl ui-ctl-checkbox"},d=["name"],s={class:"ui-ctl-label-text"};var c={__name:"checkbox-field",props:(0,a.zz)({modelValue:{type:Boolean,default:()=>!1},name:{type:String,required:!0},label:{type:String,default:()=>""}},{modelValue:{default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,a.fn)(e,"modelValue");return(o,l)=>((0,a.uX)(),(0,a.CE)("label",i,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>t.value=e),name:e.name,type:"checkbox",class:"ui-ctl-element"},null,8,d),[[n.lH,t.value]]),(0,a.Lk)("div",s,(0,r.v_)(e.label),1)]))}};const p=c;var m=p;function v(e,t,o={}){const l={...o,data:t};return BX.ajax.runAction(e,l)}function f(e,t){return E(e)?BX.Loc.getMessage(e,t):""}function E(e){return BX.Loc.hasMessage(e)}const _={emit(e,t){BX.Event.EventEmitter.emit(e,t)},subscribe(e,t){BX.Event.EventEmitter.subscribe(e,t)}},h={class:"ui-ctl ui-ctl-after-icon ui-ctl-dropdown"},y={class:"ui-ctl-after ui-ctl-icon-angle"},g=["name"],V={value:""},k=["value"];var b={__name:"select-field",props:(0,a.zz)({name:{type:String,required:!0},attributes:{type:Object,default:()=>{}},api:{type:Object,default:()=>{}},values:{type:Array,default:()=>[]}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,a.fn)(e,"modelValue"),o=e,l=(0,u.Kh)({enums:[]});(0,a.sV)(()=>{o.api?.action?i():o.values&&(l.enums=o.values)}),(0,a.wB)(()=>o.api,()=>i(),{deep:!0}),(0,a.wB)(()=>o.values,e=>l.enums=e);const i=()=>{v(o.api.action,o.api?.data||{}).then(e=>{o.api?.callback&&(e=o.api?.callback(e)),l.enums=Array.isArray(e.data)?e.data:[]}).catch(e=>{console.error(e),alert("Ошибка получения значений списка")})};return(o,i)=>((0,a.uX)(),(0,a.CE)("div",h,[(0,a.Lk)("div",y,[(0,a.bo)((0,a.Lk)("select",(0,a.v6)({"onUpdate:modelValue":i[0]||(i[0]=e=>t.value=e),name:e.name,class:"ui-ctl-element"},e.attributes),[(0,a.Lk)("option",V,(0,r.v_)((0,u.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_SELECT_SELECTED_VALUE")),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.enums,e=>((0,a.uX)(),(0,a.CE)("option",{key:e.value,value:e.value},(0,r.v_)(e.name),9,k))),128))],16,g),[[n.u1,t.value]])])]))}};const T=b;var C=T,O=(o(4114),o(8111),o(7588),{__name:"entity-selector-field",props:(0,a.zz)({selector:{type:Object}},{modelValue:{},modelModifiers:{}}),emits:(0,a.zz)(["onTagAdd","onBeforeTagAdd","onAfterTagAdd","onBeforeTagRemove","onTagRemove","onAfterTagRemove","onContainerClick","onInput","onBlur","onKeyUp","onEnter","onMetaEnter","onKeyDown","onAddButtonClick","onCreateButtonClick","afterRender"],["update:modelValue"]),setup(e,{emit:t}){const o=(0,a.fn)(e,"modelValue"),l=(0,u.KR)(),n=t,r=e,i=(0,u.Kh)({value:"",options:{},addButtonCaption:""});(0,a.sV)(()=>{d(),s()}),(0,a.wB)(()=>o.value,e=>{e!==i.value&&s()});const d=()=>{i.options={...r.selector},i.options?.addButtonCaption&&(i.options.addButtonCaption=f(i.options.addButtonCaption)||i.options.addButtonCaption),i.options.events={onTagAdd:e=>n("onTagAdd",e),onBeforeTagAdd:e=>n("onBeforeTagAdd",e),onAfterTagAdd:e=>{c(e),n("onAfterTagAdd",e)},onBeforeTagRemove:e=>n("onBeforeTagRemove",e),onTagRemove:e=>n("onTagRemove",e),onAfterTagRemove:e=>{c(e),n("onAfterTagRemove",e)},onContainerClick:e=>n("onContainerClick",e),onInput:e=>n("onInput",e),onBlur:e=>n("onBlur",e),onKeyUp:e=>n("onKeyUp",e),onEnter:e=>n("onEnter",e),onMetaEnter:e=>n("onMetaEnter",e),onKeyDown:e=>n("onKeyDown",e),onAddButtonClick:e=>n("onAddButtonClick",e),onCreateButtonClick:e=>n("onCreateButtonClick",e)}},s=()=>{BX.loadExt("ui.entity-selector").then(()=>{const e=new BX.UI.EntitySelector.TagSelector(i.options);if(l.value){l.value.innerHTML="";const t=new Promise(t=>{e.renderTo(l.value),t(e)});t.then(e=>n("afterRender",e))}})},c=e=>{let t;const l=e.target;l.isMultiple()?(t=[],e.target.getTags().forEach(e=>t.push(e.id))):t=l.getTags()[0]?.id??"",o.value=i.value=t};return(e,t)=>((0,a.uX)(),(0,a.CE)("div",{ref_key:"container",ref:l},null,512))}});const A=O;var L=A;const w={class:"ui-ctl ui-ctl-checkbox"},S=["name"];var I={__name:"input-field",props:(0,a.zz)({name:{type:String,required:!0}},{modelValue:{default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,a.fn)(e,"modelValue");return(o,l)=>((0,a.uX)(),(0,a.CE)("div",w,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>t.value=e),name:e.name,type:"text",class:"ui-ctl-element"},null,8,S),[[n.Jo,t.value]])]))}};const B=I;var R=B;const X={class:"ui-ctl ui-ctl-textbox"};var U={__name:"input-hash-field",props:(0,a.zz)({name:{type:String,required:!0},label:{type:String,default:()=>""}},{modelValue:{default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,a.fn)(e,"modelValue"),o=()=>{v("sholokhov:exchange.SecureController.generateHash").then(e=>t.value=e.data).catch(()=>alert("Ошибка генерации идентификатора"))};return(e,l)=>((0,a.uX)(),(0,a.CE)("div",X,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>t.value=e),type:"text",class:"ui-ctl-element"},null,512),[[n.Jo,t.value]]),(0,a.Lk)("span",{class:"hash-text-generator",onClick:o},"Сгенерировать")]))}};const x=U;var K=x;const H={width:"40%"},N={width:"60%"},F={key:0},G={width:"40%"},D={width:"60%"};var M={__name:"iblock-property-selector",props:{modelValue:{type:Object,default:()=>{}},property:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,l=t,n=(0,u.Kh)({iBlockOptions:{multiple:!1,addButtonCaption:"SHOLOHKOV_EXCHANGE_UI_ENTITY_SELECTOR_DIALOG_ADD_BUTTON_CAPTION_SELECT",dialogOptions:{entities:[{id:"sholokhov-exchange-iblock",dynamicSearch:!0,dynamicLoad:!0}]}}}),i=(0,a.EW)({get(){return o.modelValue||l("update:modelValue",{}),o.modelValue},set(e){l("update:modelValue",e)}}),d=(0,a.EW)({get(){return i.value?.iblock_id},set(e){e||(s.value=""),i.value.iblock_id=e}}),s=(0,a.EW)({get(){return i.value?.property_id},set(e){i.value.property_id=e}}),c=(0,a.EW)(()=>({multiple:!1,addButtonCaption:"SHOLOHKOV_EXCHANGE_UI_ENTITY_SELECTOR_DIALOG_ADD_BUTTON_CAPTION_SELECT",dialogOptions:{entities:[{id:"sholokhov-exchange-iblock-property",dynamicSearch:!0,dynamicLoad:!0,options:{iblockId:d,nameTemplate:"#NAME# (#CODE#)",...o.property?.api||{}}}]}}));return(e,t)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("tr",null,[(0,a.Lk)("td",H,(0,r.v_)((0,u.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_UI_TITLE_RENDER_IBLOCK_SELECT_IBLOCK")),1),(0,a.Lk)("td",N,[(0,a.bF)(L,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),selector:n.iBlockOptions},null,8,["modelValue","selector"])])]),d.value?((0,a.uX)(),(0,a.CE)("tr",F,[(0,a.Lk)("td",G,(0,r.v_)((0,u.R1)(f)("SHOLOKHOV_EXCHANGE_UI_ENTITY_PROPERTY_SELECTOR")),1),(0,a.Lk)("td",D,[(0,a.bF)(L,{modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=e=>s.value=e),selector:c.value},null,8,["modelValue","selector"])])])):(0,a.Q3)("",!0)],64))}};const j=M;var z=j;const W=e=>{let t=null;switch(e){case"input":t=R;break;case"checkbox":t=m;break;case"select":t=C;break;case"entity-selector":t=L;break;case"iblock-property":t=z;break}return t};var q={__name:"dynamic-field",props:(0,a.zz)({view:{type:String,required:!0},entity:{type:String,default:()=>""},options:{type:Object,default:()=>{}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,a.fn)(e,"modelValue"),o=e;(0,a.wB)(()=>t.value,e=>_.emit("sholokhov.exchange:uiUpdateValueDynamicField",{value:e,entity:o.entity}));const l=(0,a.EW)(()=>W(o.view));return(o,n)=>((0,a.uX)(),(0,a.Wv)((0,a.$y)(l.value),(0,a.v6)({modelValue:t.value,"onUpdate:modelValue":n[0]||(n[0]=e=>t.value=e)},e.options),null,16,["modelValue"]))}};const P=q;var Y=P;const Q={width:"40%"},$={width:"60%"};function J(e,t){return(0,a.uX)(),(0,a.CE)("tr",null,[(0,a.Lk)("td",Q,[(0,a.RG)(e.$slots,"title")]),(0,a.Lk)("td",$,[(0,a.RG)(e.$slots,"content")])])}var Z=o(1241);const ee={},te=(0,Z.A)(ee,[["render",J]]);var oe=te,le={__name:"general-block",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const t=(0,a.fn)(e,"modelValue");return(e,o)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,u.R1)(oe),null,{content:(0,a.k6)(()=>[(0,a.bF)((0,u.R1)(m),{modelValue:t.value.active,"onUpdate:modelValue":o[0]||(o[0]=e=>t.value.active=e),label:(0,u.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_ENTITY_UI_GENERAL_TITLE_FIELD_ACTIVE"),name:"active"},null,8,["modelValue","label"])]),_:1}),(0,a.bF)((0,u.R1)(oe),null,{title:(0,a.k6)(()=>[(0,a.eW)((0,r.v_)((0,u.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_ENTITY_UI_GENERAL_TITLE_FIELD_HASH")),1)]),content:(0,a.k6)(()=>[(0,a.bF)((0,u.R1)(K),{modelValue:t.value.hash,"onUpdate:modelValue":o[1]||(o[1]=e=>t.value.hash=e),name:"hash"},null,8,["modelValue"])]),_:1})],64))}};const ne=le;var ae=ne,ue={__name:"dynamic-fields",props:(0,a.zz)({fields:{type:Array,default:()=>[]}},{modelValue:{default:{}},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,a.fn)(e,"modelValue");return(o,l)=>((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.fields,(e,o)=>((0,a.uX)(),(0,a.CE)(a.FK,{key:o},[e.isConstructor?((0,a.uX)(),(0,a.Wv)((0,u.R1)(Y),{key:0,modelValue:t.value[e.name],"onUpdate:modelValue":o=>t.value[e.name]=o,view:e.view,entity:t.value.type,options:e.options},null,8,["modelValue","onUpdate:modelValue","view","entity","options"])):((0,a.uX)(),(0,a.Wv)((0,u.R1)(oe),{key:1},{title:(0,a.k6)(()=>[(0,a.eW)((0,r.v_)((0,u.R1)(f)(e?.title)),1)]),content:(0,a.k6)(()=>[(0,a.bF)((0,u.R1)(Y),{modelValue:t.value[e.name],"onUpdate:modelValue":o=>t.value[e.name]=o,view:e.view,entity:t.value.type,options:e.options},null,8,["modelValue","onUpdate:modelValue","view","entity","options"])]),_:2},1024))],64))),128))}};const re=ue;var ie=re,de=(o(1701),{__name:"target-block",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const t=(0,a.fn)(e,"modelValue"),o=(0,u.Kh)({targets:[],fields:[]}),l=(0,a.EW)(()=>({action:"sholokhov:exchange.EntityController.getByType",data:{code:"target"},callback:n}));(0,a.wB)(()=>t.value.type,e=>{t.value={type:t.value.type},i(e)});const n=e=>(Array.isArray(e.data)&&(e.data=e.data.map(e=>({value:e.CODE,name:e.NAME}))),e),i=e=>{v("sholokhov:exchange.EntityController.getFields",{code:e}).then(e=>o.fields=Array.isArray(e.data)?e.data:[]).catch(e=>console.error(e))};return(e,n)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,u.R1)(oe),null,{title:(0,a.k6)(()=>[(0,a.eW)((0,r.v_)((0,u.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_ENTITY_UI_TARGET_TITLE_FIELD_TYPE")),1)]),content:(0,a.k6)(()=>[(0,a.bF)((0,u.R1)(C),{modelValue:t.value.type,"onUpdate:modelValue":n[0]||(n[0]=e=>t.value.type=e),api:l.value,name:"type"},null,8,["modelValue","api"])]),_:1}),(0,a.bF)(ie,{modelValue:t.value,"onUpdate:modelValue":n[1]||(n[1]=e=>t.value=e),fields:o.fields},null,8,["modelValue","fields"])],64))}});const se=de;var ce=se,pe={__name:"App",props:{teleport:{type:Object,required:!0},formContainer:{type:String,required:!0},signed:{type:String,required:!1,default:()=>""},fields:{type:Object,default:()=>{}}},setup(e){const t=e,o=(0,u.Kh)({form:{general:{},target:{},source:{},map:{}},userForm:{}});(0,a.sV)(()=>{for(let e in t.fields)o.form[e]={};l()});const l=()=>{console.log(t);const e=document.querySelector(t.formContainer);e&&e.addEventListener("submit",e=>n(e))},n=e=>{e.preventDefault(),e.stopImmediatePropagation()};return(t,l)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[e.teleport.general?((0,a.uX)(),(0,a.Wv)(a.Im,{key:0,to:e.teleport.general},[(0,a.bF)(ae,{modelValue:o.form.general,"onUpdate:modelValue":l[0]||(l[0]=e=>o.form.general=e)},null,8,["modelValue"])],8,["to"])):(0,a.Q3)("",!0),e.teleport.target?((0,a.uX)(),(0,a.Wv)(a.Im,{key:1,to:e.teleport.target},[(0,a.bF)(ce,{modelValue:o.form.target,"onUpdate:modelValue":l[1]||(l[1]=e=>o.form.target=e)},null,8,["modelValue"])],8,["to"])):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.fields,(e,t)=>((0,a.uX)(),(0,a.Wv)(a.Im,{key:t,to:t},[(0,a.bF)(ie,{modelValue:o.form[t],"onUpdate:modelValue":e=>o.form[t]=e,fields:e},null,8,["modelValue","onUpdate:modelValue","fields"])],8,["to"]))),128))],64))}};const me=pe;var ve=me;class fe{constructor(){(0,l.A)(this,"_stores",{})}get(e){return this._stores[e]}getAll(){return this._stores}set(e,t){this._stores[e]=t}has(e){return Object.hasOwn(this._stores,e)}}window.Sholokhov||(window.Sholokhov={}),window.Sholokhov.Exchange||(window.Sholokhov.Exchange={}),window.Sholokhov.Exchange.Detail||(window.Sholokhov.Exchange.Detail=new class{constructor(){(0,l.A)(this,"_app",void 0),(0,l.A)(this,"_externalRegistry",void 0)}mounted(e,t){console.log(BX.Loc.getMessage("LANGUAGE_ID")),this._app=(0,n.Ef)(ve,t),this._app.mount(e)}unmount(){this._app?.unmount()}getExternalRegistry(){return this._externalRegistry??=new fe}})}},t={};function o(l){var n=t[l];if(void 0!==n)return n.exports;var a=t[l]={exports:{}};return e[l].call(a.exports,a,a.exports,o),a.exports}o.m=e,function(){var e=[];o.O=function(t,l,n,a){if(!l){var u=1/0;for(s=0;s<e.length;s++){l=e[s][0],n=e[s][1],a=e[s][2];for(var r=!0,i=0;i<l.length;i++)(!1&a||u>=a)&&Object.keys(o.O).every(function(e){return o.O[e](l[i])})?l.splice(i--,1):(r=!1,a<u&&(u=a));if(r){e.splice(s--,1);var d=n();void 0!==d&&(t=d)}}return t}a=a||0;for(var s=e.length;s>0&&e[s-1][2]>a;s--)e[s]=e[s-1];e[s]=[l,n,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var l in t)o.o(t,l)&&!o.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,l){var n,a,u=l[0],r=l[1],i=l[2],d=0;if(u.some(function(t){return 0!==e[t]})){for(n in r)o.o(r,n)&&(o.m[n]=r[n]);if(i)var s=i(o)}for(t&&t(l);d<u.length;d++)a=u[d],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(s)},l=self["webpackChunkdetail"]=self["webpackChunkdetail"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=o.O(void 0,[504],function(){return o(9659)});l=o.O(l)})();