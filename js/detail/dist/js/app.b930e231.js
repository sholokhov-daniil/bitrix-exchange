(function(){"use strict";var e={6110:function(e,t,o){var l=o(1114),a=o(5130),n=o(6768),u=o(144),r=o(4232);const i={class:"ui-ctl ui-ctl-checkbox"},d=["name"],s={class:"ui-ctl-label-text"};var c={__name:"checkbox-field",props:(0,n.zz)({modelValue:{type:Boolean,default:()=>!1},name:{type:String,required:!0},label:{type:String,default:()=>""}},{modelValue:{default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,n.fn)(e,"modelValue");return(o,l)=>((0,n.uX)(),(0,n.CE)("label",i,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>t.value=e),name:e.name,type:"checkbox",class:"ui-ctl-element"},null,8,d),[[a.lH,t.value]]),(0,n.Lk)("div",s,(0,r.v_)(e.label),1)]))}};const p=c;var m=p;function v(e,t,o={}){const l={...o,data:t};return BX.ajax.runAction(e,l)}function f(e,t){return E(e)?BX.Loc.getMessage(e,t):""}function E(e){return BX.Loc.hasMessage(e)}const _={emit(e,t){BX.Event.EventEmitter.emit(e,t)},subscribe(e,t){BX.Event.EventEmitter.subscribe(e,t)}},h={class:"ui-ctl ui-ctl-after-icon ui-ctl-dropdown"},y={class:"ui-ctl-after ui-ctl-icon-angle"},V=["name"],g={value:""},k=["value"];var T={__name:"select-field",props:(0,n.zz)({name:{type:String,required:!0},attributes:{type:Object,default:()=>{}},api:{type:Object,default:()=>{}},enums:{type:Array,default:()=>[]}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,n.fn)(e,"modelValue"),o=e,l=(0,u.Kh)({enums:[]});(0,n.sV)(()=>{o.api?.action?i():o.enums&&(l.enums=o.enums)}),(0,n.wB)(()=>o.api,()=>i(),{deep:!0}),(0,n.wB)(()=>o.enums,e=>l.enums=e);const i=()=>{o?.api?.action&&v(o.api.action,o.api?.data||{}).then(e=>{o.api?.callback&&(e=o.api?.callback(e)),l.enums=Array.isArray(e.data)?e.data:[]}).catch(e=>{console.error(e),alert("Ошибка получения значений списка")})};return(o,i)=>((0,n.uX)(),(0,n.CE)("div",h,[(0,n.Lk)("div",y,[(0,n.eW)((0,r.v_)(l)+" ",1),(0,n.bo)((0,n.Lk)("select",(0,n.v6)({"onUpdate:modelValue":i[0]||(i[0]=e=>t.value=e),name:e.name,class:"ui-ctl-element"},e.attributes),[(0,n.Lk)("option",g,(0,r.v_)((0,u.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_SELECT_SELECTED_VALUE")),1),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.enums,e=>((0,n.uX)(),(0,n.CE)("option",{key:e.value,value:e.value},(0,r.v_)(e.name),9,k))),128))],16,V),[[a.u1,t.value]])])]))}};const b=T;var C=b,O=(o(4114),o(8111),o(7588),{__name:"entity-selector-field",props:(0,n.zz)({selector:{type:Object}},{modelValue:{},modelModifiers:{}}),emits:(0,n.zz)(["onTagAdd","onBeforeTagAdd","onAfterTagAdd","onBeforeTagRemove","onTagRemove","onAfterTagRemove","onContainerClick","onInput","onBlur","onKeyUp","onEnter","onMetaEnter","onKeyDown","onAddButtonClick","onCreateButtonClick","afterRender"],["update:modelValue"]),setup(e,{emit:t}){const o=(0,n.fn)(e,"modelValue"),l=(0,u.KR)(),a=t,r=e,i=(0,u.Kh)({value:"",options:{},addButtonCaption:""});(0,n.sV)(()=>{d(),s()}),(0,n.wB)(()=>o.value,e=>{e!==i.value&&s()});const d=()=>{i.options={...r.selector},i.options?.addButtonCaption&&(i.options.addButtonCaption=f(i.options.addButtonCaption)||i.options.addButtonCaption),i.options.events={onTagAdd:e=>a("onTagAdd",e),onBeforeTagAdd:e=>a("onBeforeTagAdd",e),onAfterTagAdd:e=>{c(e),a("onAfterTagAdd",e)},onBeforeTagRemove:e=>a("onBeforeTagRemove",e),onTagRemove:e=>a("onTagRemove",e),onAfterTagRemove:e=>{c(e),a("onAfterTagRemove",e)},onContainerClick:e=>a("onContainerClick",e),onInput:e=>a("onInput",e),onBlur:e=>a("onBlur",e),onKeyUp:e=>a("onKeyUp",e),onEnter:e=>a("onEnter",e),onMetaEnter:e=>a("onMetaEnter",e),onKeyDown:e=>a("onKeyDown",e),onAddButtonClick:e=>a("onAddButtonClick",e),onCreateButtonClick:e=>a("onCreateButtonClick",e)}},s=()=>{BX.loadExt("ui.entity-selector").then(()=>{const e=new BX.UI.EntitySelector.TagSelector(i.options);if(l.value){l.value.innerHTML="";const t=new Promise(t=>{e.renderTo(l.value),t(e)});t.then(e=>a("afterRender",e))}})},c=e=>{let t;const l=e.target;l.isMultiple()?(t=[],e.target.getTags().forEach(e=>t.push(e.id))):t=l.getTags()[0]?.id??"",o.value=i.value=t};return(e,t)=>((0,n.uX)(),(0,n.CE)("div",{ref_key:"container",ref:l},null,512))}});const A=O;var L=A;const S={class:"ui-ctl ui-ctl-checkbox"},I=["name"];var w={__name:"input-field",props:(0,n.zz)({name:{type:String,required:!0}},{modelValue:{default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,n.fn)(e,"modelValue");return(o,l)=>((0,n.uX)(),(0,n.CE)("div",S,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>t.value=e),name:e.name,type:"text",class:"ui-ctl-element"},null,8,I),[[a.Jo,t.value]])]))}};const R=w;var B=R;const X={class:"ui-ctl ui-ctl-textbox"};var U={__name:"input-hash-field",props:(0,n.zz)({name:{type:String,required:!0},label:{type:String,default:()=>""}},{modelValue:{default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,n.fn)(e,"modelValue"),o=()=>{v("sholokhov:exchange.SecureController.generateHash").then(e=>t.value=e.data).catch(()=>alert("Ошибка генерации идентификатора"))};return(e,l)=>((0,n.uX)(),(0,n.CE)("div",X,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>t.value=e),type:"text",class:"ui-ctl-element"},null,512),[[a.Jo,t.value]]),(0,n.Lk)("span",{class:"hash-text-generator",onClick:o},"Сгенерировать")]))}};const F=U;var x=F;const K={width:"40%"},N={width:"60%"},H={key:0},G={width:"40%"},D={width:"60%"};var M={__name:"iblock-property-selector",props:{modelValue:{type:Object,default:()=>{}},property:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,l=t,a=(0,u.Kh)({iBlockOptions:{multiple:!1,addButtonCaption:"SHOLOHKOV_EXCHANGE_UI_ENTITY_SELECTOR_DIALOG_ADD_BUTTON_CAPTION_SELECT",dialogOptions:{entities:[{id:"sholokhov-exchange-iblock",dynamicSearch:!0,dynamicLoad:!0}]}}}),i=(0,n.EW)({get(){return o.modelValue||l("update:modelValue",{}),o.modelValue},set(e){l("update:modelValue",e)}}),d=(0,n.EW)({get(){return i.value?.iblock_id},set(e){e||(s.value=""),i.value.iblock_id=e}}),s=(0,n.EW)({get(){return i.value?.property_id},set(e){i.value.property_id=e}}),c=(0,n.EW)(()=>({multiple:!1,addButtonCaption:"SHOLOHKOV_EXCHANGE_UI_ENTITY_SELECTOR_DIALOG_ADD_BUTTON_CAPTION_SELECT",dialogOptions:{entities:[{id:"sholokhov-exchange-iblock-property",dynamicSearch:!0,dynamicLoad:!0,options:{iblockId:d,nameTemplate:"#NAME# (#CODE#)",...o.property?.api||{}}}]}}));return(e,t)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("tr",null,[(0,n.Lk)("td",K,(0,r.v_)((0,u.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_UI_TITLE_RENDER_IBLOCK_SELECT_IBLOCK")),1),(0,n.Lk)("td",N,[(0,n.bF)(L,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),selector:a.iBlockOptions},null,8,["modelValue","selector"])])]),d.value?((0,n.uX)(),(0,n.CE)("tr",H,[(0,n.Lk)("td",G,(0,r.v_)((0,u.R1)(f)("SHOLOKHOV_EXCHANGE_UI_ENTITY_PROPERTY_SELECTOR")),1),(0,n.Lk)("td",D,[(0,n.bF)(L,{modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=e=>s.value=e),selector:c.value},null,8,["modelValue","selector"])])])):(0,n.Q3)("",!0)],64))}};const W=M;var j=W;const z=e=>{let t=null;switch(e){case"input":t=B;break;case"checkbox":t=m;break;case"select":t=C;break;case"entity-selector":t=L;break;case"iblock-property":t=j;break}return t};var P={__name:"dynamic-field",props:(0,n.zz)({view:{type:String,required:!0},entity:{type:String,default:()=>""},options:{type:Object,default:()=>{}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,n.fn)(e,"modelValue"),o=e;(0,n.wB)(()=>t.value,e=>_.emit("sholokhov.exchange:uiUpdateValueDynamicField",{value:e,entity:o.entity}));const l=(0,n.EW)(()=>z(o.view));return(o,a)=>((0,n.uX)(),(0,n.Wv)((0,n.$y)(l.value),(0,n.v6)({modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value=e)},e.options),null,16,["modelValue"]))}};const Y=P;var q=Y;const Q={width:"40%"},$={width:"60%"};function J(e,t){return(0,n.uX)(),(0,n.CE)("tr",null,[(0,n.Lk)("td",Q,[(0,n.RG)(e.$slots,"title")]),(0,n.Lk)("td",$,[(0,n.RG)(e.$slots,"content")])])}var Z=o(1241);const ee={},te=(0,Z.A)(ee,[["render",J]]);var oe=te,le={__name:"general-block",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const t=(0,n.fn)(e,"modelValue");return(e,o)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)((0,u.R1)(oe),null,{content:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(m),{modelValue:t.value.active,"onUpdate:modelValue":o[0]||(o[0]=e=>t.value.active=e),label:(0,u.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_ENTITY_UI_GENERAL_TITLE_FIELD_ACTIVE"),name:"active"},null,8,["modelValue","label"])]),_:1}),(0,n.bF)((0,u.R1)(oe),null,{title:(0,n.k6)(()=>[(0,n.eW)((0,r.v_)((0,u.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_ENTITY_UI_GENERAL_TITLE_FIELD_HASH")),1)]),content:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(x),{modelValue:t.value.hash,"onUpdate:modelValue":o[1]||(o[1]=e=>t.value.hash=e),name:"hash"},null,8,["modelValue"])]),_:1})],64))}};const ae=le;var ne=ae,ue={__name:"dynamic-fields",props:(0,n.zz)({fields:{type:Array,default:()=>[]}},{modelValue:{default:{}},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=(0,n.fn)(e,"modelValue");return(o,l)=>((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.fields,(e,o)=>((0,n.uX)(),(0,n.CE)(n.FK,{key:o},[e.isConstructor?((0,n.uX)(),(0,n.Wv)((0,u.R1)(q),{key:0,modelValue:t.value[e.name],"onUpdate:modelValue":o=>t.value[e.name]=o,view:e.view,entity:t.value.type,options:e.options},null,8,["modelValue","onUpdate:modelValue","view","entity","options"])):((0,n.uX)(),(0,n.Wv)((0,u.R1)(oe),{key:1},{title:(0,n.k6)(()=>[(0,n.eW)((0,r.v_)((0,u.R1)(f)(e?.title)),1)]),content:(0,n.k6)(()=>[(0,n.eW)((0,r.v_)(e)+" ",1),(0,n.bF)((0,u.R1)(q),{modelValue:t.value[e.name],"onUpdate:modelValue":o=>t.value[e.name]=o,view:e.view,entity:t.value.type,options:e.options},null,8,["modelValue","onUpdate:modelValue","view","entity","options"])]),_:2},1024))],64))),128))}};const re=ue;var ie=re,de=(o(1701),{__name:"target-block",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const t=(0,n.fn)(e,"modelValue"),o=(0,u.Kh)({targets:[],fields:[]}),l=(0,n.EW)(()=>({action:"sholokhov:exchange.EntityController.getByType",data:{code:"target"},callback:a}));(0,n.wB)(()=>t.value.type,e=>{t.value={type:t.value.type},i(e)});const a=e=>(Array.isArray(e.data)&&(e.data=e.data.map(e=>({value:e.CODE,name:e.NAME}))),e),i=e=>{v("sholokhov:exchange.EntityController.getFields",{code:e}).then(e=>o.fields=Array.isArray(e.data)?e.data:[]).catch(e=>console.error(e))};return(e,a)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)((0,u.R1)(oe),null,{title:(0,n.k6)(()=>[(0,n.eW)((0,r.v_)((0,u.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_ENTITY_UI_TARGET_TITLE_FIELD_TYPE")),1)]),content:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(C),{modelValue:t.value.type,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value.type=e),api:l.value,name:"type"},null,8,["modelValue","api"])]),_:1}),(0,n.bF)(ie,{modelValue:t.value,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value=e),fields:o.fields},null,8,["modelValue","fields"])],64))}});const se=de;var ce=se,pe={__name:"source-block",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const t=(0,n.fn)(e,"modelValue"),o=(0,u.Kh)({targets:[],fields:[]}),l=(0,n.EW)(()=>({action:"sholokhov:exchange.EntityController.getByType",data:{code:"source"},callback:a}));(0,n.wB)(()=>t.value.type,e=>{t.value={type:t.value.type},i(e)});const a=e=>(Array.isArray(e.data)&&(e.data=e.data.map(e=>({value:e.CODE,name:e.NAME}))),e),i=e=>{v("sholokhov:exchange.EntityController.getFields",{code:e}).then(e=>o.fields=Array.isArray(e.data)?e.data:[]).catch(e=>console.error(e))};return(e,a)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)((0,u.R1)(oe),null,{title:(0,n.k6)(()=>[(0,n.eW)((0,r.v_)((0,u.R1)(f)("SHOLOKHOV_EXCHANGE_SETTINGS_ENTITY_UI_SOURCE_TITLE_FIELD_TYPE")),1)]),content:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(C),{modelValue:t.value.type,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value.type=e),api:l.value,name:"type"},null,8,["modelValue","api"])]),_:1}),(0,n.bF)(ie,{modelValue:t.value,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value=e),fields:o.fields},null,8,["modelValue","fields"])],64))}};const me=pe;var ve=me,fe={__name:"App",props:{teleport:{type:Object,required:!0},formContainer:{type:String,required:!0},signed:{type:String,required:!1,default:()=>""},fields:{type:Object,default:()=>{}}},setup(e){const t=e,o=(0,u.Kh)({form:{general:{},target:{},source:{},map:{}},userForm:{}});(0,n.sV)(()=>{for(let e in t.fields)o.form[e]={};l()});const l=()=>{console.log(t);const e=document.querySelector(t.formContainer);e&&e.addEventListener("submit",e=>a(e))},a=e=>{e.preventDefault(),e.stopImmediatePropagation()};return(t,l)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[e.teleport.general?((0,n.uX)(),(0,n.Wv)(n.Im,{key:0,to:e.teleport.general},[(0,n.bF)(ne,{modelValue:o.form.general,"onUpdate:modelValue":l[0]||(l[0]=e=>o.form.general=e)},null,8,["modelValue"])],8,["to"])):(0,n.Q3)("",!0),e.teleport.target?((0,n.uX)(),(0,n.Wv)(n.Im,{key:1,to:e.teleport.target},[(0,n.bF)(ce,{modelValue:o.form.target,"onUpdate:modelValue":l[1]||(l[1]=e=>o.form.target=e)},null,8,["modelValue"])],8,["to"])):(0,n.Q3)("",!0),e.teleport.source?((0,n.uX)(),(0,n.Wv)(n.Im,{key:2,to:e.teleport.source},[(0,n.bF)(ve,{modelValue:o.form.source,"onUpdate:modelValue":l[2]||(l[2]=e=>o.form.source=e)},null,8,["modelValue"])],8,["to"])):(0,n.Q3)("",!0),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.fields,(e,t)=>((0,n.uX)(),(0,n.Wv)(n.Im,{key:t,to:t},[(0,n.bF)(ie,{modelValue:o.form[t],"onUpdate:modelValue":e=>o.form[t]=e,fields:e},null,8,["modelValue","onUpdate:modelValue","fields"])],8,["to"]))),128))],64))}};const Ee=fe;var _e=Ee;class he{constructor(){(0,l.A)(this,"_stores",{})}get(e){return this._stores[e]}getAll(){return this._stores}set(e,t){this._stores[e]=t}has(e){return Object.hasOwn(this._stores,e)}}window.Sholokhov||(window.Sholokhov={}),window.Sholokhov.Exchange||(window.Sholokhov.Exchange={}),window.Sholokhov.Exchange.Detail||(window.Sholokhov.Exchange.Detail=new class{constructor(){(0,l.A)(this,"_app",void 0),(0,l.A)(this,"_externalRegistry",void 0)}mounted(e,t){console.log(BX.Loc.getMessage("LANGUAGE_ID")),this._app=(0,a.Ef)(_e,t),this._app.mount(e)}unmount(){this._app?.unmount()}getExternalRegistry(){return this._externalRegistry??=new he}})}},t={};function o(l){var a=t[l];if(void 0!==a)return a.exports;var n=t[l]={exports:{}};return e[l].call(n.exports,n,n.exports,o),n.exports}o.m=e,function(){var e=[];o.O=function(t,l,a,n){if(!l){var u=1/0;for(s=0;s<e.length;s++){l=e[s][0],a=e[s][1],n=e[s][2];for(var r=!0,i=0;i<l.length;i++)(!1&n||u>=n)&&Object.keys(o.O).every(function(e){return o.O[e](l[i])})?l.splice(i--,1):(r=!1,n<u&&(u=n));if(r){e.splice(s--,1);var d=a();void 0!==d&&(t=d)}}return t}n=n||0;for(var s=e.length;s>0&&e[s-1][2]>n;s--)e[s]=e[s-1];e[s]=[l,a,n]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var l in t)o.o(t,l)&&!o.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,l){var a,n,u=l[0],r=l[1],i=l[2],d=0;if(u.some(function(t){return 0!==e[t]})){for(a in r)o.o(r,a)&&(o.m[a]=r[a]);if(i)var s=i(o)}for(t&&t(l);d<u.length;d++)n=u[d],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(s)},l=self["webpackChunkdetail"]=self["webpackChunkdetail"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=o.O(void 0,[504],function(){return o(6110)});l=o.O(l)})();